require 'rest_client'
repozytorium = RestClient::Resource.new('http://mk.datanet.cyfronet.pl/user', :user => 'login', :password => 'haslo')

def time(nr)
  t_start = Time.new
  yield
  puts "watek #{nr} czas: #{Time.new - t_start}"
end

def thread
  Thread.new do
    begin
      yield
    rescue Exception => e
      puts "exception #{e}"
    end
  end
end

def error
  begin
    yield
  rescue Exception => e
    puts "zlapalem wyjatek #{e}"
  end
end

50.times { |counter| thread { time(counter) { 100.times { error { repozytorium.get } } } } }


pobranie pustego repozytorium:
time { 1000.times { repozytorium.get } }

1      0.013563999
100    1.246501604
200    3.43609845
500    6.825705767
1000   13.337716892

pobranie repo ze 100 elementami:

1      0.046134417
100    2.883393653
200    6.060666761
500    15.146457606
1000   31.612803398

pobranie repo ze 200 elementami:

1      0.032253689
100    4.364634333
200    9.028774894
500    24.336064637
1000   36.35671561

pobranie repo ze 500 elementami:

1      0.070838319
100    5.483687004
200    12.061847925
500    28.274332204
1000   56.933844987

pobranie repo ze 1000 elementow:

1      0.105639488
100    9.452786589
200    24.443471531
500    58.000175128
1000   116.029301887

Rownoczesny odczyt 100 razy 1000 encji przez NR liczbe userow:

1      9.388309364
10:
        66.093883663
        66.759420476
        66.862998256
        68.424564195
        68.539258031
        68.955621611
        68.9820629
        69.165443374
        69.412476313
        69.454061736
20:
        132.663432648
        133.263757613
        136.979041304
        137.068038244
        138.034056616
        139.032057584
        140.370647499
        140.428240611
        140.473280264
        141.397261225
        142.501028714
        142.544698834
        142.707525135
        142.90567273
        142.974303546
        144.291634609
        144.453510704
        144.743378066
        144.797063779
        145.096518747
50:
        zaczely leciec 500tki

Dodanie elementu:

time { 1000.times { repozytorium.post jdata.to_json, content_type: :json } }


1      0.015457189
100    1.560017331
200    3.354933357
500    8.768436469
1000   17.921143671

Kasowanie:
time { 1000.times { repozytorium[list.pop['id']].delete } }

1      0.015985329
100    2.22416368
200    7.916491743
500    8.020721697
1000   17.304245417


